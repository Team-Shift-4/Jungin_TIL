---
icon: square
description: 7장-고급 계산 기법에 관한 내용을 정리한 문서이다.
---

# 7. Adcanced Counting Techniques

## 7.1. Recurrence Relations

### Recurrence Relations

모든 Integer $$n$$에 대해 $$n\geq n_0$$이고 $$n_0\geq 0$$인 $$\{a_n\}$$의 Recurrence relation(점화식)은 $$a_n$$을 Sequence의 이전 Term($$a_0, a_1, \dots , a_{n-1}$$)에 대한 Express로 표현하는 Equation이다.\
Sequence가 Recurrence relation을 만족한다면 Sequence를 Solution of a recurrence relation(재귀 관계의 해)라고 부른다.

{% hint style="success" %}
Example

Sequence $$\{a_n\}$$가 $$a_n=a_{n-1}-a_{n-2}(n=2,3,4, \dots)$$를 만족할 때 $$a_0=3, a_1=5$$일 때 $$a_2, a_3$$의 Value

* Solution\
  $$a_2=a_1-a_0=5-3=2, a_3=a_2-a_1=2-5=-3$$으로 구할 수 있다.
{% endhint %}

{% hint style="success" %}
Example

$$a_n=2a_{n-1}-a_{n-2}$$가 $$n=2,3,4,\dots$$에서 Recurrence relation 성립 여부

*   Solution\
    Nonnegative integer $$n$$에 대해 $$a_n=3n$$이라고 가정하면 $$n\geq 2$$일 때 $$2a_{n-1}-a_{n-2}=2(3(n-1))-3(n-2)=3n=a_n$$이 성립한다.

    Nonnegative integer $$n$$에 대해 $$a_n=2^n$$이라고 가정하면 $$n\geq 2$$일 때 $$2a_{n-1}-a_{n-2}=2(2(n-1))-2(n-2)=2^n-2^{n-2}\not=a_n$$으로 성립하지 않는다\
    Nonnegative integer $$n$$에 대해 $$a_n=5$$라고 가정하면 $$n\geq 2$$일 때 $$2a_{n-1}-a_{n-2}=2(5)-5=5=a_n$$으로 성립한다.
{% endhint %}

Sequence의Initial condition은 Recurrence relation이 적용되기 이전의 Term들을 지정한다.\
Initial condition은 Sequence를 고유하게 결정한다.

### Modeling with Recurrence Relations

{% hint style="success" %}
Example

Compound Interest\
연 11%의 복리이자를 제공하는 은행의 저축 계좌에 10000원을 예치할 경우 30년 후 계좌 금액

* Solution\
  $$n$$년 후 계좌 금액을 $$P_n$$으로 정의할 경우 $$n$$년 후 계좌 금액은 $$n-1$$년 후 계좌 금액에 $$n$$년 차 이자를 더한 것이므로 $$\{P_n\}, P_n=P_{n-1}+0.11P_{n-1}=1.11P_{n-1}, P0=10000$$이다.\
  Initial condition을 대입하여 $$P_n=(1.11)^n\cdot 10000$$임을 알 수 있다.\
  Recurrence relation과 Induction hypothesis에 따라 $$P_{n+1}=(1.11)P_n=(1.11)^{n+1}\cdot 10000$$이다.\
  따라서 30년 후 계좌 금액은 $$P_{30}=(1.11)^{30}\cdot 10000=228922.97$$로 구할 수 있다.
{% endhint %}

{% hint style="success" %}
Example

Rabbits and the Fibonacci Numbers\
한 쌍의 어린 토끼(수컷, 암컷)가 섬에 놓이고 토끼 한 쌍은 2개월이 지나면 각 토끼 쌍은 매달 새로운 쌍을 생산할 때 $$n$$개월 후 섬에 있는 토끼 쌍의 수

* Solution\
  $$n$$개월 후 토끼 쌍의 수를 $$f_n$$으로 나타낼 때 $$f_n$$은 Fibonacci sequence의 Term임을 증명할 수 있다.\
  첫 달이 끝날 때 토끼 쌍의 수 $$f_1=1$$, 두 번째 달이 끝날 때 역시 $$f_2=1$$이다.\
  두 달이 지난 토끼 쌍만 번식하므로 $$f_n=f_{n-1}+f_{n-2}$$이다.\
  즉, $$n$$개월 후 섬에 있는 토끼 쌍의 수는 $$n$$번째 Fibonacci number가 된다.
{% endhint %}

{% hint style="success" %}
Example

The Tower of Hanoi\
3개의 기둥에 다양한 크기의 원판으로 구성되어 있으며 첫 번째 기둥에 내림차순으로 원판들이 쌓여 있을 때 원판은 한 번에 하나, 다른 기둥으로만 옮길 수 있고 더 큰 원판이나 바닥에만 원판을 놓을 수 있을 때 $$n$$개의 원판을 세 번째 기둥에 모두 다 옮기는 데 필요한 이동 횟수

* Solution\
  $$H_n$$을 $$n$$개의 원판이 있는 The tower of hanoi의 해결 이동횟수라고 할 때 이전에 이동시킨 원판의 이동횟수의 두 배 + 1회가 해결 이동횟수임을 알 수 있다.\
  즉 $$H_n=2H_{n-1}+1$$이고 $$H_1=1$$이 Initial condition이다.\
  $$H_n=2H_{n-1}+1\\=2(2H_{n-2}+1)+1=2^2H_{n-2}+2+1\\=2^2(2H_{n-3}+1)+2+1=2^3H_{n-3}+2^2+2+1\\ \cdots \\ = 2^n-1$$\
  로 $$H_1$$에서도 성립하는 Formula를 생성할 수 있다.
{% endhint %}

{% hint style="success" %}
Example

Codeword Enumeration\
0이 짝수 개인 경우에만 10진 Number string을 유효한 Codeword로 간주할 때 $$a_n$$이 유효한 $$n$$자릿수 10진 Codeword의 가짓수 일 때 $$a_n$$의 Recurrence relation

* Solution\
  먼저 $$a_1$$은 0을 제외한 한자리 수 이므로 9이다.\
  이 때 유효한 Codeword에 유효하지 않은 Codeword를 붙여 Codeword로 만들 수 있다.\
  즉 $$n-1$$자리 Codeword에 Codeword가 아닌(1\~9)를 붙이거나 Codeword가 아닌 Number string에 0을 붙여 Codeword를 만들 수 있다.\
  전자는 $$9a_{n-1}$$이고 후자는 $$10^{n-1}-a_{n-1}$$이다.\
  따라서 $$a_n=9a_{n-1}+(10^{n-1}-a_{n-1})=8a_{n-1}+10^{n-1}$$임을 구할 수 있다.
{% endhint %}

{% hint style="success" %}
Example

$$n+1$$개의 숫자 $$x_0, x_1, \dots, x_n$$의 Product의 순서를 지정하기 위해 괄호 치는 방법의 수 $$C_n$$에 대한 Recurrence relation

* Solution\
  $$C_n$$의 Recurrence relation을 도출하기 위해 $$x_0\cdot x_1 \cdot ... \cdot x_n$$의 Product에서 하나의 $$\cdot$$이 괄호 사이에 나와 있음을 인지해야 한다.\
  예시로 $$C_2=2$$일 때 $$(x_0\cdot x_1)\cdot x_2,\ x_0\cdot (x_1\cdot x_2)$$로 확인 가능하다.\
  즉, 마지막 연산은 어떠한 수 사이에 Operation($$\cdot$$)이 존재하므로 괄호 삽입 방법 수는 $$C_n=C_0C_{n-1}+C_1C_{n-2}+\cdots+C_{n-2}C_1+C_{n-1}C_0$$이므로 $$\sum_{k=0}^{ n-1}C_kC_{n-k-1}$$임을 알 수 있다.\
  Initial term $$C_0=C_1=1$$임을 확인해 $$C_n$$의 Recurrence relation은 $$\frac{C(2n, n)}{n+1}$$가 성립함을 알 수 있다.\
  추가적으로 위 Sequence $$\{C_n\}$$은 Catalan number의 Sequence이다.
{% endhint %}

## 7.2. Solving Linear Recurrence Relations

Linear homogeneous recurrence relation of degree(차수의 선형 동차 점화식)은 Real number $$c_1,c_2,\dots , c_k(c_k/not=0)$$에 대해 $$a_n=c_1a_{n-1}+c_2a_{n-2}+\cdots+c_ka_{n-k}$$를 만족하는 Recurrence relation이다.\
Sequence의 Term의 Degree는 모두 Constant이며 $$n$$에 의해 변화하지 않기 때문에 Homogeneous(동차)이다.\
$$a_n$$이 Sequence의 이전 $$k$$개의 Term으로 표현되기 때문에 Degree는 $$k$$이다.\
즉 Recurrence relation을 만족하는 Sequence는 Recurrence relation과 Initial condition에 의해 고유하게 결정($$a_0=C_0, a_1=C_1, \cdots,a_{k-1}=C_{k-1}$$)된다.

{% hint style="info" %}
Information

Recurrence relation $$P_n=(1.11)P_{n-1}$$은 Linear homogeneous recurrence relation of degree 1(1차 선형 동차 점화식), Recurrence relation $$f_n=f_{n-1}+f_{n-2}$$는 Linear homogeneous recurrence relation of degree 2, Recurrence relation $$a_n=a_{n-5}$$는 Linear homogeneous recurrence relation of degree 5이다.

Recurrence relation $$a_n=a_{n-1}+a^2_{n-2}$$는 Linear recurrence relation이 아니다.\
Recurrence relation $$H_n=2H_{n-1}+1$$은 Homogeneous recurrence relation이 아니다.\
Recurrence relation $$B_n=nB_{n-1}$$은 Constant coefficient(상수 계수)가 없어 Linear homogeneous recurrence relation이 아니다.
{% endhint %}

### Solving Linear Homogeneous Recurrence Relations with Constant Coefficients

487

